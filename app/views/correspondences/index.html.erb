<% title 'Graduate Applicant | ' + @graduate_applicant.full_name + ' | Correspondence' %>

<p style="color: green"><%= flash[:notice] %></p>

<%= render :partial => 'graduate_applicants/navigation',
           :locals  => {:page               => 'Correspondence',
                        :graduate_applicant => @graduate_applicant } %>

<% form_tag graduate_applicant_correspondences_path(@graduate_applicant), :method => 'get' do %>
	<p>
		<%= text_field_tag :search, params[:search] %>
		<%= submit_tag "Search" %>
	</p>
<% end %>

<table>
  <tr>
    <th>Sent date</th>
    <th>Text</th>
    <th>Type</th>
    <th colspan=4>Controls</th>
  </tr>

<% for correspondence in @correspondences %>
  <tr id="<%= dom_id(correspondence) %>" class="<%= cycle('even', 'odd') %>">
    <td><%=h correspondence.sent_on %></td>
    <td><%=h correspondence.body_short %></td>
    <td><%=h correspondence.correspondence_type %></td>
    <td><%= link_to 'Show', correspondence %></td>
    <td><%= link_to 'Print', { :action => "print", :graduate_applicant_id => correspondence.graduate_applicant.id, :correspondence_id => correspondence.id }, :popup => true %></td>
    <td><%= mail_to correspondence.graduate_applicant.email, 'Email', :body => correspondence.text %></td>
    <td><%= link_to image_tag("remove.png", :border => 0), correspondence, :confirm => 'Are you sure?', :method => :delete %></td>
  </tr>
<% end %>
</table>

<% will_paginate @correspondences %>

<br />

<p>
  <%= link_to 'Send Correspondence', new_graduate_applicant_correspondence_path(@graduate_applicant) %> | 
  <%= link_to 'Back to Graduate Applicants', graduate_applicants_path %>
</p>